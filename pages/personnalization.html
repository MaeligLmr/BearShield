<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BearShield</title>
    <link rel="icon" type="image/x-icon" href="../assets/img/favicon.ico">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/index.css">
    <link rel="stylesheet" href="../assets/css/personnalization.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https//fonts.googleapis.com">
    <link rel="preconnect" href="https//fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
    <div data-component="header"></div>

    <main class="p-4 p-t-max relative">
        <div class="w-100 flex">
            <!-- Remplacer cette ligne -->
            <!-- <img src="../assets/img/product/photo-phone.jpeg" alt="Phone Photo" class="img-produit"> -->

            <!-- Par le SVG interactif -->
            <svg id="phone-case" viewBox="0 0 300.7 542.91" class="img-produit">
                <defs>
                    <linearGradient id="plasticGloss" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="0%" stop-color="white" stop-opacity="0.6" />
                        <stop offset="50%" stop-color="white" stop-opacity="0.2" />
                        <stop offset="100%" stop-color="white" stop-opacity="0" />
                    </linearGradient>

                </defs>
                <path id="bottom" class="bottom"
                    d="M257.89,6.68H43.09C22.81,6.68,6.37,23.05,6.37,43.24v456.33c0,20.19,16.44,36.56,36.71,36.56h214.8c20.28,0,36.71-16.37,36.71-36.56V43.24c0-20.19-16.44-36.56-36.71-36.56ZM125.59,105.35c0,12.17-9.91,22.04-22.13,22.04h-44.27c-12.22,0-22.13-9.87-22.13-22.04v-44.08c0-12.17,9.91-22.04,22.13-22.04h44.27c12.22,0,22.13,9.87,22.13,22.04v44.08Z" />
                <path id="interior" class="interior"
                    d="M255.51,17.12H42.95c-16.02,0-29,12.98-29,29v454c0,16.02,12.98,29,29,29h212.56c16.02,0,29-12.98,29-29V46.12c0-16.02-12.98-29-29-29ZM124.87,106.12c0,12.15-9.85,22-22,22h-44c-12.15,0-22-9.85-22-22v-44c0-12.15,9.85-22,22-22h44c12.15,0,22,9.85,22,22v44Z" />
                <path id="top-left" class="top-left"
                    d="M1.13,55.59h5.25c-.32-2.53-2.24-20.16,10.93-34.67C30.59,6.26,48.55,6.59,51.07,6.68V1.93c-2.07-.22-24.05-2.2-39.35,15.19C-2.56,33.35.68,53.13,1.13,55.59Z" />
                <path id="bottom-left" class="bottom-left"
                    d="M54.44,542.15v-6.03c-1.35.24-24.17,3.86-39.02-13.03-10.49-11.94-10.07-26.24-9.9-29.46H.83c-.26,4.24-.6,18.51,9.24,31.23,15.83,20.46,42.93,17.47,44.36,17.29Z" />
                <path id="bottom-right" class="bottom-right"
                    d="M247.6,542.15v-6.03c17.48,2.07,33.92-4.95,41.98-18.1,6.02-9.82,5.51-20.04,5.02-24.39h4.96c.75,5.4,1.16,14.86-3.61,24.39-7.96,15.92-27.01,25.36-48.35,24.14Z" />
                <path id="top-right" class="top-right"
                    d="M247.78.61v6.03c17.48-2.07,33.92,4.95,41.98,18.1,6.02,9.82,5.51,20.04,5.02,24.39h4.96c.75-5.4,1.16-14.86-3.61-24.39-7.96-15.92-27.01-25.36-48.35-24.14Z" />
                <path id="btn-1" class="btn-1"
                    d="M294.6,89.18h2.71c1.5,0,2.71,1.21,2.71,2.71v32.79c0,1.5-1.21,2.71-2.71,2.71h-2.71v-38.21h0Z" />
                <path id="btn-2" class="btn-2"
                    d="M294.6,133.46h0c2.99,0,5.42,2.43,5.42,5.42v27.37c0,2.99-2.43,5.42-5.42,5.42h0v-38.21h0Z" />
                <path id="btn-3" class="btn-3"
                    d="M.96,93.26h0c2.99,0,5.42,2.43,5.42,5.42v39.37c0,2.99-2.43,5.42-5.42,5.42h0v-50.21h0Z"
                    transform="translate(7.33 236.73) rotate(180)" />

            </svg>
        </div>
        <div class="w-100">
            <h1 class="mt-4 text-orange">Personnalise ta coque</h1>
            <form id="customization-form" class="customisation-form" action="#" method="post"
                class="flex flex-col gap-4 align-start p-2">
                <div class="w-100 flex flex-col align-start">
                    <label for="phone-model" class="font-bold text-bleu">Choisi ton téléphone</label>
                    <div class="select-container">
                        <select id="phone-model" name="phone-model" class=".phone-model" required>
                            <option value="">Sélectionner un modèle</option>
                            <option value="iphone-14">iPhone 14</option>
                            <option value="samsung-s22">Samsung Galaxy S22</option>
                            <option value="google-pixel-7">Google Pixel 7</option>
                        </select>
                        <i class="fas fa-chevron-down select-arrow"></i>
                    </div>
                </div>
                <div class="w-100">
                    <label for="color" class="font-bold text-bleu">Couleur de la coque</label>
                    <div class="color-selector">
                        <label class="color-option">
                            <input type="radio" name="color" value="transparent" required>
                            <div class="color-circle color-transparent"></div>
                        </label>
                        <label class="color-option">
                            <input type="radio" name="color" value="#2b2b2b" required>
                            <div class="color-circle color-noir"></div>
                        </label>
                        <label class="color-option">
                            <input type="radio" name="color" value="#ff6b35" required>
                            <div class="color-circle color-primary"></div>
                        </label>
                        <label class="color-option">
                            <input type="radio" name="color" value="#924036" required>
                            <div class="color-circle color-bordeaux"></div>
                        </label>
                        <label class="color-option">
                            <input type="radio" name="color" value="#205780" required>
                            <div class="color-circle color-secondary"></div>
                        </label>
                    </div>
                </div>
                <div class="w-100">
                    <label for="finish" class="font-bold text-bleu">Finition </label>
                    <div class="toggle-container">
                        <label class="toggle-switch">
                            <input type="checkbox" id="finish" class=".finish" name="finish" value="brillant">
                            <span class="toggle-slider">
                                <span class="toggle-text-left">Mat</span>
                                <span class="toggle-text-right">Brillant</span>
                            </span>
                        </label>
                    </div>
                </div>
                <div class="w-100">
                    <label for="material" class="font-bold text-bleu">Matière de la coque </label>
                    <div class="toggle-container">
                        <label class="toggle-switch">
                            <input type="checkbox" id="material" name="material" class=".material" value="souple">
                            <span class="toggle-slider">
                                <span class="toggle-text-left">Rigide</span>
                                <span class="toggle-text-right">Souple</span>
                            </span>
                        </label>
                    </div>
                </div>
                <div class="w-100">
                    <label for="corner-type" class="font-bold text-bleu">Type de coins </label>
                    <div class="toggle-container">
                        <label class="toggle-switch">
                            <input type="checkbox" id="corner-type" class=".corner-type" name="corner-type"
                                value="renforcés">
                            <span class="toggle-slider">
                                <span class="toggle-text-left">Standard</span>
                                <span class="toggle-text-right">Renforcés</span>
                            </span>
                        </label>
                    </div>
                </div>
                <div class="w-100">
                    <label for="button-type" class="font-bold text-bleu">Type de boutons </label>
                    <div class="toggle-container">
                        <label class="toggle-switch">
                            <input type="checkbox" id="button-type" class=".button-type" name="button-type"
                                value="renforcés">
                            <span class="toggle-slider">
                                <span class="toggle-text-left">Standard</span>
                                <span class="toggle-text-right">Renforcés</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="w-100">
                    <label for="accessories" class="font-bold text-bleu">Accessoires supplémentaires</label>
                    <div class="products-grid products-grid-personnalization" id="preview-accessories"></div>
                </div>
            </form>
        </div>
        <div class="price-bar">
            <div class="price-info">
                <p class="price-label">Prix total</p>
                <p class="price-amount" id="total-price">29,99€</p>
            </div>
            <div class="selected-accessories" id="selected-accessories"></div>
            <button type="submit" form="customization-form" class="add-to-cart-btn">
                <i class="fas fa-shopping-cart"></i>
                Ajouter au panier
            </button>
        </div>
    </main>
    <script>
        let gripsData = [];
        let selectedAccessories = new Set();
        const BASE_PRICE = 29.99;

        function updateTotalPrice() {
            let total = BASE_PRICE;
            const accessoriesContainer = document.querySelector('.selected-accessories');

            accessoriesContainer.innerHTML = '';

            selectedAccessories.forEach(id => {
                const grip = gripsData.find(g => g.id === id);
                if (grip) {
                    total += grip.price;

                    const accessoryPreview = document.createElement('div');
                    accessoryPreview.className = 'accessory-preview';
                    accessoryPreview.innerHTML = `<img src="${grip.image}" alt="${grip.name}" title="${grip.name} (+${grip.price.toFixed(2)}€)">`;
                    accessoriesContainer.appendChild(accessoryPreview);
                }
            });

            document.querySelector('.price-amount').textContent = total.toFixed(2) + '€';
        }

        function createAccessoryCard(grip) {
            const isSelected = selectedAccessories.has(grip.id);
            return `
                <div class="accessory-card ${isSelected ? 'selected' : ''}" data-grip-id="${grip.id}">
                    <input type="checkbox" name="accessories" value="grip-${grip.id}" class="accessory-checkbox" ${isSelected ? 'checked' : ''} hidden>
                    <img src="${grip.image}" alt="${grip.name}" class="accessory-image">
                    <div class="accessory-info">
                        <p class="accessory-name">${grip.name}</p>
                        <span class="accessory-price">+${grip.price.toFixed(2)}€</span>
                    </div>
                </div>
            `;
        }

        function updateAccessoriesDisplay() {
            const container = document.querySelector('#preview-accessories');
            if (!container || !gripsData.length) return;

            container.innerHTML = gripsData.map(createAccessoryCard).join('');

            const accessoryCards = container.querySelectorAll('.accessory-card');
            accessoryCards.forEach(card => {
                card.addEventListener('click', (e) => {
                    const gripId = parseInt(card.getAttribute('data-grip-id'));
                    const checkbox = card.querySelector('.accessory-checkbox');
                    if (selectedAccessories.has(gripId)) {
                        selectedAccessories.delete(gripId);
                        card.classList.remove('selected');
                        checkbox.checked = false;
                    } else {
                        selectedAccessories.add(gripId);
                        card.classList.add('selected');
                        checkbox.checked = true;
                    }
                    updateTotalPrice();
                });
            });
            updateTotalPrice();
        }

        function loadAccessoriesForCustomization() {
            fetch('../data/products.json')
                .then(res => res.json())
                .then(products => {
                    gripsData = products.filter(product => product.type === 'grip');
                    updateAccessoriesDisplay();
                })
                .catch(error => {
                    console.error('Erreur lors du chargement des accessoires:', error);
                });
        }

        document.addEventListener('DOMContentLoaded', loadAccessoriesForCustomization);
    </script>
    <script src="../assets/js/components/components.js" type="module"></script>
    <script src="../assets/js/components/cart-manager.js"></script>
    <script src="../assets/js/components/cart-badge.js"></script>
    <script src="../assets/js/pages/personnalization.js" defer></script>

</body>

</html>